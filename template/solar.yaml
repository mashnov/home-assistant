## SOLAR
- sensor:
  - name: 'solar'
    state: "{{ states('sun.sun') }}"
    icon: >
      {% set isHight = state_attr('binary_sensor.solar', 'hight') %}
      {{ iif(isHight, 'mdi:sun-wireless', 'mdi:sun-wireless-outline', 'mdi:help-circle') }}
    attributes:
      azimuth: "{{ state_attr('sun.sun', 'azimuth')  | int(0) }}"
      elevation: "{{ state_attr('sun.sun', 'elevation') | int(0) }}"

- binary_sensor:
  - name: 'solar'
    state: "{{ state_attr('binary_sensor.solar', 'hight') }}"
    icon: >
      {% set isHight = state_attr('binary_sensor.solar', 'hight') %}
      {{ iif(isHight, 'mdi:sun-wireless', 'mdi:sun-wireless-outline', 'mdi:help-circle') }}
    attributes:      
      azimuth: >
        {% set sensorValue = state_attr('sensor.solar', 'azimuth') | int(0) %}
        {% set targetValue = states('input_number.solar_azimuth_target') | int(0) %}
        {% set offsetValue = states('input_number.solar_azimuth_offset') | int(0) %}
        {% set minValue = targetValue - offsetValue %}
        {% set maxValue = targetValue + offsetValue %}
        {{ minValue < sensorValue < maxValue }}
      elevation: >
        {% set sensorValue = state_attr('sensor.solar', 'elevation') | int(0) %}
        {% set targetValue = states('input_number.solar_elevation_target') | int(0) %}
        {% set offsetValue = states('input_number.solar_elevation_offset') | int(0) %}
        {% set minValue = targetValue - offsetValue %}
        {% set maxValue = targetValue + offsetValue %}
        {{ minValue < sensorValue < maxValue }}
      hight: >
        {% set azimuthValue = state_attr('binary_sensor.solar', 'azimuth') %}
        {% set elevationValue = state_attr('binary_sensor.solar', 'elevation') %}
        {{ azimuthValue and elevationValue }}
