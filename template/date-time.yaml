## DATE_TIME
- sensor:
  - name: 'date_time'
    state: "{{ utcnow() }}"
    device_class: 'timestamp'
    icon: "mdi:calendar-clock"
    attributes:
      dmy_hms_z: '{{ as_timestamp(utcnow()) | timestamp_custom("%d %m %Y %H:%M:%S %z", false) }}'
      dmy_hm_z: '{{ as_timestamp(utcnow()) | timestamp_custom("%d %m %Y %H:%M %z", false) }}'
      dmy_hms: '{{ as_timestamp(utcnow()) | timestamp_custom("%d %m %Y %H:%M:%S", false) }}'
      dmy_hm: '{{ as_timestamp(utcnow()) | timestamp_custom("%d %m %Y %H:%M", false) }}'
      dmy: '{{ as_timestamp(utcnow()) | timestamp_custom("%d %m %Y", false) }}'
      hmz: '{{ as_timestamp(utcnow()) | timestamp_custom("%H:%M %z", false) }}'
      hms: '{{ as_timestamp(utcnow()) | timestamp_custom("%H:%M:%S", false) }}'
      hm: '{{ as_timestamp(utcnow()) | timestamp_custom("%H:%M", false) }}'
      z: '{{ as_timestamp(utcnow()) | timestamp_custom("%z", false) }}'
      dmy_hms_z_local: '{{ as_timestamp(now()) | timestamp_custom("%d %m %Y %H:%M:%S %z") }}'
      dmy_hm_z_local: '{{ as_timestamp(now()) | timestamp_custom("%d %m %Y %H:%M %z") }}'
      dmy_hms_local: '{{ as_timestamp(now()) | timestamp_custom("%d %m %Y %H:%M:%S") }}'
      dmy_hm_local: '{{ as_timestamp(now()) | timestamp_custom("%d %m %Y %H:%M") }}'
      dmy_local: '{{ as_timestamp(now()) | timestamp_custom("%d %m %Y") }}'
      hmz_local: '{{ as_timestamp(now()) | timestamp_custom("%H:%M %z") }}'
      hms_local: '{{ as_timestamp(now()) | timestamp_custom("%H:%M:%S") }}'
      hm_local: '{{ as_timestamp(now()) | timestamp_custom("%H:%M") }}'
      z_local: '{{ as_timestamp(now()) | timestamp_custom("%z") }}'

- binary_sensor:
  - name: 'date_time'
    state: "{{ state_attr('binary_sensor.date_time', 'night') }}"
    icon: >
      {% set isNightIcon = state_attr('binary_sensor.date_time', 'night') and 'mdi:clock-time-eleven-outline' %}
      {% set isMorningIcon = state_attr('binary_sensor.date_time', 'morning') and 'mdi:clock-time-nine' %}
      {% set isDayIcon = state_attr('binary_sensor.date_time', 'day') and 'mdi:clock-time-eleven' %}
      {% set isEveningIcon = state_attr('binary_sensor.date_time', 'evening') and 'mdi:clock-time-nine-outline' %}
      {% set defaultIcon = 'mdi:help-circle' %}
      {{ isNightIcon or isMorningIcon or isDayIcon or isEveningIcon or defaultIcon }}
    attributes:
      night: >
        {% set timeNow = strptime(state_attr('sensor.date_time', 'hm_local'), '%H:%M').time() %}
        {% set timeFrom = strptime(states('input_datetime.date_time_night_time'), "%H:%M:%S").time() %}
        {% set timeTill = strptime(states('input_datetime.date_time_morning_time'), "%H:%M:%S").time() %}
        {% if timeFrom > timeTill %}
          {{ (timeFrom <= timeNow) or (timeNow <= timeTill) }}
        {% else %}
          {{ (timeFrom <= timeNow) and (timeNow <= timeTill) }}
        {% endif %}
      morning: >
        {% set timeNow = strptime(state_attr('sensor.date_time', 'hm_local'), '%H:%M').time() %}
        {% set timeFrom = strptime(states('input_datetime.date_time_morning_time'), "%H:%M:%S").time() %}
        {% set timeTill = strptime(states('input_datetime.date_time_day_time'), "%H:%M:%S").time() %}
        {% if timeFrom > timeTill %}
          {{ (timeFrom <= timeNow) or (timeNow <= timeTill) }}
        {% else %}
          {{ (timeFrom <= timeNow) and (timeNow <= timeTill) }}
        {% endif %}
      day: >
        {% set timeNow = strptime(state_attr('sensor.date_time', 'hm_local'), '%H:%M').time() %}
        {% set timeFrom = strptime(states('input_datetime.date_time_day_time'), "%H:%M:%S").time() %}
        {% set timeTill = strptime(states('input_datetime.date_time_evening_time'), "%H:%M:%S").time() %}
        {% if timeFrom > timeTill %}
          {{ (timeFrom <= timeNow) or (timeNow <= timeTill) }}
        {% else %}
          {{ (timeFrom <= timeNow) and (timeNow <= timeTill) }}
        {% endif %}
      evening: >
        {% set timeNow = strptime(state_attr('sensor.date_time', 'hm_local'), '%H:%M').time() %}
        {% set timeFrom = strptime(states('input_datetime.date_time_evening_time'), "%H:%M:%S").time() %}
        {% set timeTill = strptime(states('input_datetime.date_time_night_time'), "%H:%M:%S").time() %}
        {% if timeFrom > timeTill %}
          {{ (timeFrom <= timeNow) or (timeNow <= timeTill) }}
        {% else %}
          {{ (timeFrom <= timeNow) and (timeNow <= timeTill) }}
        {% endif %}
