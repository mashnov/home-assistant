- sensor:
  - name: 'i_level'
    device_class: 'illuminance'
    unit_of_measurement: 'lx'
    state: "{{ state_attr('sensor.balcony_illuminance', 'illuminance_lux') | int(0) }}"

- binary_sensor:
  - name: 'i_kitchen_curtain_state'
    state: >
      {% set isCloudly = is_state('binary_sensor.c_boolean', 'on') %}
      {% set targetCloudly = states('input_number.i_kitchen_curtain_cloudly_target') | int(0) %}
      {% set targetSunny = states('input_number.i_kitchen_curtain_sunny_target') | int(0) %}
      {% set targetValue = iif(isCloudly, targetCloudly, targetSunny) %}
      {% set sensorValue = states('input_number.i_level') | int(0) %}
      {{ sensorValue > targetValue }}

  - name: 'i_kitchen_top_light_state'
    state: >
      {% set isCloudly = is_state('binary_sensor.c_boolean', 'on') %}
      {% set targetCloudly = states('input_number.i_kitchen_top_light_cloudly_target') | int(0) %}
      {% set targetSunny = states('input_number.i_kitchen_top_light_sunny_target') | int(0) %}
      {% set targetValue = iif(isCloudly, targetCloudly, targetSunny) %}
      {% set sensorValue = states('input_number.i_level') | int(0) %}
      {{ sensorValue < targetValue }}

  - name: 'i_kitchen_back_light_state'
    state: >
      {% set isCloudly = is_state('binary_sensor.c_boolean', 'on') %}
      {% set targetCloudly = states('input_number.i_kitchen_back_light_cloudly_target') | int(0) %}
      {% set targetSunny = states('input_number.i_kitchen_back_light_sunny_target') | int(0) %}
      {% set targetValue = iif(isCloudly, targetCloudly, targetSunny) %}
      {% set sensorValue = states('input_number.i_level') | int(0) %}
      {{ sensorValue < targetValue }}

  - name: 'i_hall_top_light_state'
    state: >
      {% set isCloudly = is_state('binary_sensor.c_boolean', 'on') %}
      {% set targetCloudly = states('input_number.i_hall_top_light_cloudly_target') | int(0) %}
      {% set targetSunny = states('input_number.i_hal_top_light_sunny_target') | int(0) %}
      {% set targetValue = iif(isCloudly, targetCloudly, targetSunny) %}
      {% set sensorValue = states('input_number.i_level') | int(0) %}
      {{ sensorValue < targetValue }}

  - name: 'i_hall_back_light_state'
    state: >
      {% set isCloudly = is_state('binary_sensor.c_boolean', 'on') %}
      {% set targetCloudly = states('input_number.i_hall_back_light_cloudly_target') | int(0) %}
      {% set targetSunny = states('input_number.i_hal_back_light_sunny_target') | int(0) %}
      {% set targetValue = iif(isCloudly, targetCloudly, targetSunny) %}
      {% set sensorValue = states('input_number.i_level') | int(0) %}
      {{ sensorValue < targetValue }}

  - name: 'i_bedroom_curtain_state'
    state: >
      {% set isCloudly = is_state('binary_sensor.c_boolean', 'on') %}
      {% set targetCloudly = states('input_number.i_bedroom_curtain_cloudly_target') | int(0) %}
      {% set targetSunny = states('input_number.i_bedroom_curtain_sunny_target') | int(0) %}
      {% set targetValue = iif(isCloudly, targetCloudly, targetSunny) %}
      {% set sensorValue = states('input_number.i_level') | int(0) %}
      {{ sensorValue > targetValue }}

  - name: 'i_bedroom_back_light_state'
    state: >
      {% set isCloudly = is_state('binary_sensor.c_boolean', 'on') %}
      {% set targetCloudly = states('input_number.i_bedroom_back_light_cloudly_target') | int(0) %}
      {% set targetSunny = states('input_number.i_bedroom_back_light_sunny_target') | int(0) %}
      {% set targetValue = iif(isCloudly, targetCloudly, targetSunny) %}
      {% set sensorValue = states('input_number.i_level') | int(0) %}
      {{ sensorValue < targetValue }}

  - name: 'i_living_curtain_state'
    state: >
      {% set isCloudly = is_state('binary_sensor.c_boolean', 'on') %}
      {% set targetCloudly = states('input_number.i_living_curtain_cloudly_target') | int(0) %}
      {% set targetSunny = states('input_number.i_living_curtain_sunny_target') | int(0) %}
      {% set targetValue = iif(isCloudly, targetCloudly, targetSunny) %}
      {% set sensorValue = states('input_number.i_level') | int(0) %}
      {{ sensorValue > targetValue }}

  - name: 'i_living_back_light_state'
    state: >
      {% set isCloudly = is_state('binary_sensor.c_boolean', 'on') %}
      {% set targetCloudly = states('input_number.i_living_backlight_cloudly_target') | int(0) %}
      {% set targetSunny = states('input_number.i_living_backlight_sunny_target') | int(0) %}
      {% set targetValue = iif(isCloudly, targetCloudly, targetSunny) %}
      {% set sensorValue = states('input_number.i_level') | int(0) %}
      {{ sensorValue < targetValue }}

  - name: 'i_kitchen_curtain_boolean'
    state: "{{ is_state('input_boolean.i_kitchen_curtain_state', 'on') }}"

  - name: 'i_kitchen_back_light_boolean'
    state: "{{ is_state('input_boolean.i_kitchen_back_light_state', 'on') }}"

  - name: 'i_kitchen_top_light_boolean'
    state: "{{ is_state('input_boolean.i_kitchen_top_light_state', 'on') }}"

  - name: 'i_hall_top_light_boolean'
    state: "{{ is_state('input_boolean.i_hall_top_light_state', 'on') }}"

  - name: 'i_hall_back_light_boolean'
    state: "{{ is_state('input_boolean.i_hall_back_light_state', 'on') }}"

  - name: 'i_bedroom_curtain_boolean'
    state: "{{ is_state('input_boolean.i_bedroom_curtain_state', 'on') }}"

  - name: 'i_bedroom_back_light_boolean'
    state: "{{ is_state('input_boolean.i_bedroom_back_light_state', 'on') }}"

  - name: 'i_living_curtain_boolean'
    state: "{{ is_state('input_boolean.i_living_curtain_state', 'on') }}"

  - name: 'i_living_back_light_boolean'
    state: "{{ is_state('input_boolean.i_living_back_light_state', 'on') }}"


