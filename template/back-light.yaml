## BACK LIGHT ON SENSORS
- binary_sensor:
  - name: 'back_light_kitchen_on'
    device_class: 'plug'
    state: "{{ is_state('binary_sensor.relay_kitchen_2_on', 'on') }}"
    icon: 'mdi:led-strip-variant'

  - name: 'back_light_hall_on'
    device_class: 'plug'
    state: "{{ is_state('binary_sensor.relay_hall_1_on', 'on') }}"
    icon: 'mdi:led-strip-variant'

  - name: 'back_light_bedroom_1_on'
    device_class: 'plug'
    state: "{{ is_state('binary_sensor.relay_bedroom_1_on', 'on') }}"
    icon: 'mdi:led-strip-variant'

  - name: 'back_light_bedroom_2_on'
    device_class: 'plug'
    state: "{{ is_state('binary_sensor.switch_bedroom_3_on', 'on') }}"
    icon: 'mdi:string-lights'

  - name: 'back_light_living_on'
    device_class: 'plug'
    state: "{{ is_state('binary_sensor.relay_living_2_on', 'on') }}"
    icon: 'mdi:led-strip-variant'

  - name: 'back_light_balcony_on'
    device_class: 'plug'
    state: "{{ is_state('binary_sensor.relay_balcony_2_on', 'on') }}"
    icon: 'mdi:led-strip-variant'

## BACK LIGHT PERMISSION
  - name: 'back_light_kitchen_permission'
    device_class: 'lock'
    icon: 'mdi:check-all'
    state: >
      {% set isButtonOn = is_state('binary_sensor.button_kitchen_left_on', 'on') %}
      {% set isOccupancy = is_state('binary_sensor.motion_kitchen_boolean', 'on') %}
      {% set isIlluminanceLow = is_state('binary_sensor.illuminance_kitchen_back_light_boolean', 'on') %}
      {% set ignoreIlluminance = is_state('input_boolean.back_light_ignore_kitchen_illuminance', 'on') %}
      {% set illuminancePermission = isIlluminanceLow or ignoreIlluminance %}
      {% set isNightMode = is_state('binary_sensor.night_mode_hall_boolean', 'on') %}
      {% set ignoreNightMode = is_state('input_boolean.back_light_ignore_kitchen_night_mode', 'on') %}
      {% set nightModePermission = not(isNightMode) or ignoreNightMode %}
      {{ isButtonOn or (nightModePermission and isOccupancy and illuminancePermission) }}

  - name: 'back_light_hall_permission'
    device_class: 'lock'
    icon: 'mdi:check-all'
    state: >
      {% set isButtonOn = is_state('binary_sensor.button_hall_both_on', 'on') %}
      {% set isIlluminanceLow = is_state('binary_sensor.illuminance_hall_back_light_boolean', 'on') %}
      {% set ignoreIlluminance = is_state('input_boolean.back_light_ignore_hall_illuminance', 'on') %}
      {% set illuminancePermission = isIlluminanceLow or ignoreIlluminance %}
      {% set isNightMode = is_state('binary_sensor.night_mode_hall_boolean', 'on') %}
      {% set ignoreNightMode = is_state('input_boolean.back_light_ignore_hall_night_mode', 'on') %}
      {% set nightModePermission = not(isNightMode) or ignoreNightMode %}
      {{ isButtonOn or (nightModePermission and illuminancePermission) }}

  - name: 'back_light_bedroom_permission'
    device_class: 'lock'
    icon: 'mdi:check-all'
    state: >
      {% set isButtonOn = is_state('binary_sensor.button_bedroom_left_on', 'on') %}
      {% set isIlluminanceLow = is_state('binary_sensor.illuminance_bedroom_back_light_boolean', 'on') %}
      {% set ignoreIlluminance = is_state('input_boolean.back_light_ignore_bedroom_illuminance', 'on') %}
      {% set illuminancePermission = isIlluminanceLow or ignoreIlluminance %}
      {% set isNightMode = is_state('binary_sensor.night_mode_bedroom_boolean', 'on') %}
      {% set ignoreNightMode = is_state('input_boolean.back_light_ignore_bedroom_night_mode', 'on') %}
      {% set nightModePermission = not(isNightMode) or ignoreNightMode %}
      {{ isButtonOn or (nightModePermission and illuminancePermission) }}

  - name: 'back_light_living_permission'
    device_class: 'lock'
    icon: 'mdi:check-all'
    state: >
      {% set isButtonOn = is_state('binary_sensor.button_living_left_on', 'on') %}
      {% set isIlluminanceLow = is_state('binary_sensor.illuminance_living_back_light_boolean', 'on') %}
      {% set ignoreIlluminance = is_state('input_boolean.back_light_ignore_living_illuminance', 'on') %}
      {% set illuminancePermission = isIlluminanceLow or ignoreIlluminance %}
      {% set isNightMode = is_state('binary_sensor.night_mode_living_boolean', 'on') %}
      {% set ignoreNightMode = is_state('input_boolean.back_light_ignore_living_night_mode', 'on') %}
      {% set nightModePermission = not(isNightMode) or ignoreNightMode %}
      {{ isButtonOn or (nightModePermission and illuminancePermission) }}

  - name: 'back_light_balcony_permission'
    device_class: 'lock'
    icon: 'mdi:check-all'
    state: "{{ is_state('binary_sensor.button_balcony_doublet_on', 'on') }}"
