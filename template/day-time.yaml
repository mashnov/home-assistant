- sensor:
  - name: 'day-time'
    device_class: 'timestamp'
    state: "{{ now() }}"
    icon: >
      {% set isNightIcon = state_attr('sensor.day_time', 'night_state') and 'mdi:clock-time-eleven-outline' %}
      {% set isMorningIcon = state_attr('sensor.day_time', 'morning_state') and 'mdi:clock-time-nine' %}
      {% set isDayIcon = state_attr('sensor.day_time', 'day_state') and 'mdi:clock-time-eleven' %}
      {% set isEveningIcon = state_attr('sensor.day_time', 'evening_state') and 'mdi:clock-time-nine-outline' %}
      {% set defaultIcon = 'mdi:help-circle' %}
      {{ isNightIcon or isMorningIcon or isDayIcon or isEveningIcon or defaultIcon }}
    attributes:
      night_state: >
        {% set timeNow = strptime(state_attr('sensor.date_time', 'hm_local'), '%H:%M').time() %}
        {% set timeFrom = strptime(states('input_datetime.dt_night_time'), "%H:%M:%S").time() %}
        {% set timeTill = strptime(states('input_datetime.dt_morning_time'), "%H:%M:%S").time() %}
        {% if timeFrom > timeTill %}
          {{ (timeFrom <= timeNow) or (timeNow <= timeTill) }}
        {% else %}
          {{ (timeFrom <= timeNow) and (timeNow <= timeTill) }}
        {% endif %}
      morning_state: >
        {% set timeNow = strptime(state_attr('sensor.date_time', 'hm_local'), '%H:%M').time() %}
        {% set timeFrom = strptime(states('input_datetime.dt_morning_time'), "%H:%M:%S").time() %}
        {% set timeTill = strptime(states('input_datetime.dt_day_time'), "%H:%M:%S").time() %}
        {% if timeFrom > timeTill %}
          {{ (timeFrom <= timeNow) or (timeNow <= timeTill) }}
        {% else %}
          {{ (timeFrom <= timeNow) and (timeNow <= timeTill) }}
        {% endif %}
      day_state: >
        {% set timeNow = strptime(state_attr('sensor.date_time', 'hm_local'), '%H:%M').time() %}
        {% set timeFrom = strptime(states('input_datetime.dt_day_time'), "%H:%M:%S").time() %}
        {% set timeTill = strptime(states('input_datetime.dt_evening_time'), "%H:%M:%S").time() %}
        {% if timeFrom > timeTill %}
          {{ (timeFrom <= timeNow) or (timeNow <= timeTill) }}
        {% else %}
          {{ (timeFrom <= timeNow) and (timeNow <= timeTill) }}
        {% endif %}
      evening_state: >
        {% set timeNow = strptime(state_attr('sensor.date_time', 'hm_local'), '%H:%M').time() %}
        {% set timeFrom = strptime(states('input_datetime.dt_evening_time'), "%H:%M:%S").time() %}
        {% set timeTill = strptime(states('input_datetime.dt_night_time'), "%H:%M:%S").time() %}
        {% if timeFrom > timeTill %}
          {{ (timeFrom <= timeNow) or (timeNow <= timeTill) }}
        {% else %}
          {{ (timeFrom <= timeNow) and (timeNow <= timeTill) }}
        {% endif %}

      night_boolean: "{{ is_state('input_boolean.dt_night', 'on') }}"
      morning_boolean: "{{ is_state('input_boolean.dt_morning', 'on') }}"
      day_boolean: "{{ is_state('input_boolean.dt_day', 'on') }}"
      evening_boolean: "{{ is_state('input_boolean.dt_evening', 'on') }}"

