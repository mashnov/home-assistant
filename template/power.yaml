- sensor:
  - name: 'power'
    unit_of_measurement: 'W'
    device_class: 'power'
    state: "{{ state_attr('sensor.power', 'averageW') }}"
    icon: 'mdi:meter-electric-outline'
    attributes:
      averageW: >
        {% set kitchenValue = state_attr('sensor.power', 'kitchenW') | float(0) | round(1) %}
        {% set bathValue = state_attr('sensor.power', 'bathW') | float(0) | round(1) %}
        {% set toiletValue = state_attr('sensor.power', 'toiletW') | float(0) | round(1) %}
        {% set hallValue = state_attr('sensor.power', 'hallW') | float(0) | round(1) %}
        {% set bedroomValue = state_attr('sensor.power', 'bedroomW') | float(0) | round(1) %}
        {% set livingValue = state_attr('sensor.power', 'livingW') | float(0) | round(1) %}
        {% set balcony1Value = state_attr('sensor.power', 'balcony1W') | float(0) | round(1) %}
        {% set balcony2Value = state_attr('sensor.power', 'balcony2W') | float(0) | round(1) %}
        {{ kitchenValue + bathValue + toiletValue + hallValue + bedroomValue + livingValue + balcony1Value + balcony2Value }}
      averageV: >
        {% set kitchenValue = state_attr('sensor.power', 'kitchenV') | float(0) | round(1) %}
        {% set bathValue = state_attr('sensor.power', 'bathV') | float(0) | round(1) %}
        {% set toiletValue = state_attr('sensor.power', 'toiletV') | float(0) | round(1) %}
        {% set hallValue = state_attr('sensor.power', 'hallV') | float(0) | round(1) %}
        {% set bedroomValue = state_attr('sensor.power', 'bedroomV') | float(0) | round(1) %}
        {% set livingValue = state_attr('sensor.power', 'livingV') | float(0) | round(1) %}
        {% set balconyValue1 = state_attr('sensor.power', 'balcony1V') | float(0) | round(1) %}
        {% set balconyValue2 = state_attr('sensor.power', 'balcony2V') | float(0) | round(1) %}
        {{ (kitchenValue + bathValue + toiletValue + hallValue + bedroomValue + livingValue + balconyValue1 + balconyValue2) / 7 }}
      averageA: >
        {% set kitchenValue = state_attr('sensor.power', 'kitchenA') | float(0) | round(1) %}
        {% set bathValue = state_attr('sensor.power', 'bathA') | float(0) | round(1) %}
        {% set toiletValue = state_attr('sensor.power', 'toiletA') | float(0) | round(1) %}
        {% set hallValue = state_attr('sensor.power', 'hallA') | float(0) | round(1) %}
        {% set bedroomValue = state_attr('sensor.power', 'bedroomA') | float(0) | round(1) %}
        {% set livingValue = state_attr('sensor.power', 'livingA') | float(0) | round(1) %}
        {% set balcony1Value = state_attr('sensor.power', 'balcony1A') | float(0) | round(1) %}
        {% set balcony2Value = state_attr('sensor.power', 'balcony2A') | float(0) | round(1) %}
        {{ kitchenValue + bathValue + toiletValue + hallValue + bedroomValue + livingValue + balcony1Value + balcony2Value }}
      kitchenW: "{{ states('sensor.kitchen_relay_power')}}"
      kitchenV: "{{ state_attr('sensor.kitchen_relay_power', 'voltage') }}"
      kitchenA: "{{ state_attr('sensor.kitchen_relay_power', 'current') }}"
      bathW: "{{ states('sensor.bath_relay_power')}}"
      bathV: "{{ state_attr('sensor.bath_relay_power', 'voltage')}}"
      bathA: "{{ state_attr('sensor.bath_relay_power', 'current')}}"
      toiletW: "{{ states('sensor.toilet_relay_power')}}"
      toiletV: "{{ state_attr('sensor.toilet_relay_power', 'voltage')}}"
      toiletA: "{{ state_attr('sensor.toilet_relay_power', 'current')}}"
      hallW: "{{ states('sensor.hall_relay_power')}}"
      hallV: "{{ state_attr('sensor.hall_relay_power', 'voltage')}}"
      hallA: "{{ state_attr('sensor.hall_relay_power', 'current')}}"
      bedroomW: "{{ states('sensor.bedroom_relay_power')}}"
      bedroomV: "{{ state_attr('sensor.bedroom_relay_power', 'voltage')}}"
      bedroomA: "{{ state_attr('sensor.bedroom_relay_power', 'current')}}"
      livingW: "{{ states('sensor.living_relay_power')}}"
      livingV: "{{ state_attr('sensor.living_relay_power', 'voltage')}}"
      livingA: "{{ state_attr('sensor.living_relay_power', 'current')}}"
      balcony1W: "{{ states('sensor.balcony_socket_relay_power')}}"
      balcony1V: "{{ state_attr('sensor.balcony_socket_relay_power', 'voltage')}}"
      balcony1A: "{{ state_attr('sensor.balcony_socket_relay_power', 'current')}}"
      balcony2W: "{{ states('sensor.balcony_light_relay_power_2')}}"
      balcony2V: "{{ state_attr('sensor.balcony_light_relay_power_2', 'voltage')}}"
      balcony2A: "{{ state_attr('sensor.balcony_light_relay_power_2', 'current')}}"
