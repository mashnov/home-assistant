climat_illuminance:
  sensor:
  - platform: statistics
    name: climat_illuminance_max
    unique_id: climat_illuminance_max
    entity_id: sensor.climat_illuminance_virtual
    state_characteristic: value_max
    max_age:
      days: 1

  - platform: statistics
    name: climat_illuminance_average
    unique_id: climat_illuminance_average
    entity_id: sensor.climat_illuminance_virtual
    state_characteristic: average_timeless
    max_age:
      minutes: 10


  binary_sensor:
  - platform: trend
    sensors:
      climat_illuminance_is_decreasing:
        entity_id: sensor.climat_illuminance_average
        sample_duration: 3600
        invert: true

  template:
  - sensor:
    - name: climat_illuminance_virtual
      unique_id: climat_illuminance_virtual
      device_class: illuminance
      unit_of_measurement: lx
      state: "{{ states('sensor.illuminance_balcony') | round(1, default = 0) | float }}"