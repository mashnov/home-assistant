climat_pressure:
  sensor:
  - platform: min_max
    name: climat_pressure_average
    unique_id: climat_pressure_average
    type: mean
    round_digits: 0
    entity_ids:
    - sensor.climat_pressure_kitchen_virtual
    - sensor.climat_pressure_hall_virtual
    - sensor.climat_pressure_toilet_virtual
    - sensor.climat_pressure_bedroom_virtual
    - sensor.climat_pressure_living_virtual

  binary_sensor:
  - platform: trend
    sensors:
      climat_pressure_is_increasing:
        entity_id: sensor.climat_pressure_average
        sample_duration: 7200
        max_samples: 120
        min_samples: 20

      climat_pressure_is_decreasing:
        entity_id: sensor.climat_pressure_average
        sample_duration: 7200
        max_samples: 120
        min_samples: 20
        invert: true

  template:
  - sensor:
    - name: climat_pressure_kitchen_virtual
      unique_id: climat_pressure_kitchen_virtual
      device_class: pressure
      unit_of_measurement: mmHg
      state: "{{ states('sensor.pressure_kitchen') | round(1, default = 0) | float }}"

    - name: climat_pressure_hall_virtual
      unique_id: climat_pressure_hall_virtual
      device_class: pressure
      unit_of_measurement: mmHg
      state: "{{ states('sensor.pressure_hall') | round(1, default = 0) | float }}"

    - name: climat_pressure_toilet_virtual
      unique_id: climat_pressure_toilet_virtual
      device_class: pressure
      unit_of_measurement: mmHg
      state: "{{ states('sensor.pressure_toilet') | round(1, default = 0) | float }}"

    - name: climat_pressure_bedroom_virtual
      unique_id: climat_pressure_bedroom_virtual
      device_class: pressure
      unit_of_measurement: mmHg
      state: "{{ states('sensor.pressure_bedroom') | round(1, default = 0) | float }}"

    - name: climat_pressure_living_virtual
      unique_id: climat_pressure_living_virtual
      device_class: pressure
      unit_of_measurement: mmHg
      state: "{{ states('sensor.pressure_living') | round(1, default = 0) | float }}"
