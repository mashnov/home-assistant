camera_living:
  input_text:
    camera_living_photo_name:
      initial: 'snapshot.jpg'
    camera_living_photo_caption:
      initial: 'Камера в гостиной'

  template:
  - sensor:
    - name: 'camera_living_photo_link'
      state: >
        {% set path = '/tmp/' %}
        {% set name = states('input_text.camera_living_photo_name') %}
        {{ path + name }}

    - name: 'camera_living_photo_message'
      state: >
        {% set path = '/tmp/' %}
        {% set name = states('input_text.camera_living_photo_name') %}
        {{ path + name }}

  camera:
  - platform: proxy
    name: 'living_propxy'
    entity_id: camera.living
    max_stream_width: 360
    max_image_width: 640

  script:
    camera_living_take_photo:
      mode: 'queued'
      sequence:
      - service: camera.snapshot
        entity_id: camera.living_propxy
        data:
          filename: "{{ states('sensor.camera_living_photo_link') }}"
      - service: script.telegramm_send_photo
        data_template:
          message: "{{ states('sensor.camera_living_photo_caption') }}"
          link: "{{ states('sensor.camera_living_photo_link') }}"
