blocker:
  input_boolean:
    top_light_kitchen_blocker:
    top_light_hall_blocker:
    top_light_bath_blocker:
    top_light_bedroom_blocker:
    top_light_living_blocker:
    back_light_kitchen_blocker:
    back_light_balcony_blocker:
    night_light_bath_blocker:
    night_light_balcony_blocker:
    fan_toilet_blocker:
    outlet_balcony_sprinkler_blocker:
    outlet_balcony_socket_blocker:

  timer:
    blocker_top_light_kitchen:
      duration: '01:00:00'
    blocker_top_light_hall:
      duration: '01:00:00'
    blocker_top_light_bath:
      duration: '01:00:00'
    blocker_top_light_bedroom:
      duration: '01:00:00'
    blocker_top_light_living:
      duration: '01:00:00'
    blocker_back_light_kitchen:
      duration: '01:00:00'
    blocker_back_light_balcony:
      duration: '00:10:00'
    blocker_night_light_bath:
      duration: '01:00:00'
    blocker_night_light_balcony:
      duration: '00:10:00'
    blocker_fan_toilet:
      duration: '00:10:00'
    blocker_outlet_balcony_sprinkler:
      duration: '00:10:00'
    blocker_outlet_balcony_socket:
      duration: '01:00:00'

  automation:
  - alias: 'blocker_top_light_kitchen'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.switch_kitchen_action
      to: 'single_left'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.top_light_kitchen_blocker

  - alias: 'blocker_back_light_kitchen'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.switch_kitchen_action
      to: 'single_right'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.back_light_kitchen_blocker

  - alias: 'blocker_top_light_hall'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.switch_hall_action
      to: 'single'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.top_light_hall_blocker

  - alias: 'blocker_top_light_bath'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.button_bath_action
      to: 'double'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.top_light_bath_blocker

  - alias: 'blocker_night_light_bath_button'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.button_bath_action
      to: 'single'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.night_light_bath_blocker

  - alias: 'blocker_light_bath'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.switch_restroom_action
      to: 'single_right'
    action:
    - choose:
      - conditions:
        - condition: template
          value_template: >
            {% set isNightLightBlocker = is_state("input_boolean.night_light_bath_blocker", "on") %}
            {% set isTopLightBlocker = is_state("input_boolean.top_light_bath_blocker", "on") %}
            {{ isNightLightBlocker or isTopLightBlocker }}
        sequence:
        - parallel:
          - service: input_boolean.turn_off
            entity_id: input_boolean.night_light_bath_blocker
          - service: input_boolean.turn_off
            entity_id: input_boolean.top_light_bath_blocker
      - conditions:
        - condition: state
          entity_id: input_boolean.night_light_bath_blocker
          state: 'off'
        - condition: state
          entity_id: input_boolean.is_night_mode
          state: 'on'
        sequence:
        - service: input_boolean.turn_on
          entity_id: input_boolean.night_light_bath_blocker
      - conditions:
        - condition: state
          entity_id: input_boolean.night_light_bath_blocker
          state: 'off'
        - condition: state
          entity_id: input_boolean.is_night_mode
          state: 'off'
        sequence:
        - parallel:
          - service: input_boolean.turn_on
            entity_id: input_boolean.night_light_bath_blocker
          - service: input_boolean.turn_on
            entity_id: input_boolean.top_light_bath_blocker

  - alias: 'blocker_top_light_bedroom'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.switch_bedroom_action
      to: 'single_left'
    - platform: state
      entity_id: sensor.switch_bedroom_action
      to: 'single_right'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.top_light_bedroom_blocker

  - alias: 'blocker_top_light_living'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.switch_living_action
      to: 'single_left'
    - platform: state
      entity_id: sensor.switch_living_action
      to: 'single_right'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.top_light_living_blocker

  - alias: 'blocker_back_light_balcony'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.button_balcony_action
      to: 'double'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.back_light_balcony_blocker

  - alias: 'blocker_night_light_balcony'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.button_balcony_action
      to: 'single'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.night_light_balcony_blocker

  - alias: 'blocker_fan_toilet'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.button_toilet_action
      to: 'single'
    - platform: state
      entity_id: sensor.button_bath_action
      to: 'hold'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.fan_toilet_blocker

  - alias: 'blocker_outlet_balcony_socket'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.button_balcony_action
      to: 'hold'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.outlet_balcony_socket_blocker

  - alias: 'blocker_outlet_balcony_sprinkler'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: sensor.button_balcony_action
      to: 'shake'
    action:
    - service: input_boolean.toggle
      entity_id: input_boolean.outlet_balcony_sprinkler_blocker

