automation_living_cover:
  input_number:
    automation_living_cover_step: 
      max: 60
      min: 0
      # 4

    automation_living_cover_day: 
      max: 100
      min: 0
      # 5

    automation_living_cover_night: 
      max: 100
      min: 0
      # 55

  automation:
  - alias: automation_living_cover_day
    mode: queued
    trigger:
    - platform: state
      entity_id: input_boolean.night_mode_hall
      from: "on"
      to: "off"
    action:
    - service: cover.set_cover_position
      entity_id: cover.curtain_living
      data_template:
        position: "{{ states('input_number.automation_living_cover_day') | int(0) }}"

  - alias: automation_living_cover_night
    mode: queued
    trigger:
    - platform: state
      entity_id: input_boolean.night_mode_hall
      from: "off"
      to: "on"
    action:
    - service: cover.set_cover_position
      entity_id: cover.curtain_living
      data_template:
        position: "{{ states('input_number.automation_living_cover_night') | int(0) }}"

  - alias: automation_living_cover_controll_right
    mode: queued
    trigger:
    - platform: state
      entity_id: sensor.living_cube_action
      to: "rotate_right"
    action:
    - service: cover.set_cover_position
      entity_id: cover.curtain_living
      data_template:
        position: >
          {% set step = states('input_number.automation_living_cover_step') | int(0) %}
          {% set position = state_attr('cover.curtain_living', 'position') | int(0) + step %}
          {{ 0 if position < 0 else (100 if position > 100 else position) }}

  - alias: automation_living_cover_controll_left
    mode: queued
    trigger:
    - platform: state
      entity_id: sensor.living_cube_action
      to: "rotate_left"
    action:
    - service: cover.set_cover_position
      entity_id: cover.curtain_living
      data_template:
        position: >
          {% set step = states('input_number.automation_living_cover_step') | int(0) %}
          {% set position = state_attr('cover.curtain_living', 'position') | int(0) - step %}
          {{ 0 if position < 0 else (100 if position > 100 else position) }}
