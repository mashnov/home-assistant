automation_hall_xiaomi:
  automation:
  - alias: automation_hall_xiaomi
    trigger:
    - platform: state
      entity_id: sensor.light_top_hall_brightness
    - platform: state
      entity_id: sensor.light_top_hall_temperature
    - platform: state
      entity_id: "{{ states.light | selectattr('entity_id', 'search', 'light_xiaomi') | map(attribute='entity_id') | join(', ') }}"
      to: "on"
    action:
    - service: light.turn_on
      entity_id: "{{ states.light | selectattr('state', 'eq', 'on') | selectattr('entity_id', 'search', 'light_xiaomi') | map(attribute='entity_id') | join(', ') }}"
      data_template:
        brightness: "{{ states('sensor.light_top_hall_brightness') | int(50) }}"
        color_temp: "{{ states('sensor.light_top_hall_temperature') | int(333) }}"
