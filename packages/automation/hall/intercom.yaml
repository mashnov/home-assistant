automation_hall_intercom:
  automation:
  - alias: automation_hall_intercom_call
    trigger: 
    - platform: state
      entity_id: switch.intercom_hall
      from: "off"
      to: "on"
    condition:
    - condition: state
      entity_id: input_boolean.intercom_hall_call
      state: "off"
    action:
    - service: input_boolean.turn_on
      entity_id: input_boolean.intercom_hall_call
    - delay: "{{ states('sensor.intercom_hall_call_duration') }}"
    - service: input_boolean.turn_off
      entity_id: input_boolean.intercom_hall_call

  - alias: automation_hall_intercom_auto_open
    trigger: 
    - platform: state
      entity_id: input_boolean.intercom_hall_call
      from: "off"
      to: "on"
    condition:
    - condition: state
      entity_id: input_boolean.intercom_hall_enabled
      state: "on"
    - condition: state
      entity_id: input_boolean.intercom_hall_open
      state: "off"
    action:
    - delay: "{{ states('sensor.intercom_hall_open_delay') }}"
    - service: lock.unlock
      entity_id: lock.intercom_hall
