telegramm:
  telegram_bot: 
  - platform: polling
    api_key: !secret telegram_bot_api_key
    allowed_chat_ids:
    - !secret telegram_home_group_id
    - !secret telegram_climat_group_id
    - !secret telegram_system_group_id
    - !secret telegram_secuirity_group_id
    - !secret telegram_own_id

  notify:
  - platform: telegram
    name: telegram_home_group_id
    chat_id: !secret telegram_home_group_id

  - platform: telegram
    name: telegram_climat_group_id
    chat_id: !secret telegram_climat_group_id

  - platform: telegram
    name: telegram_secuirity_group_id
    chat_id: !secret telegram_secuirity_group_id

  - platform: telegram
    name: telegram_system_group_id
    chat_id: !secret telegram_system_group_id

  automation:
  - alias: telegram_restart_command
    mode: 'queued'
    trigger:
    - platform: event
      event_type: telegram_callback
      event_data:
        command: '/restart'
    - platform: event
      event_type: telegram_command
      event_data:
        command: '/restart'
    - platform: event
      event_type: telegram_command
      event_data:
        command: '/restart@casa_d_amore_bot'
    action:
    - service: script.system_restart

  - alias: telegram_reboot_command
    mode: 'queued'
    trigger:
    - platform: event
      event_type: telegram_callback
      event_data:
        command: '/reboot'
    - platform: event
      event_type: telegram_command
      event_data:
        command: '/reboot'
    - platform: event
      event_type: telegram_command
      event_data:
        command: '/reboot@casa_d_amore_bot'
    action:
    - service: script.system_reboot

  - alias: telegram_rebuild_command
    mode: 'queued'
    trigger:
    - platform: event
      event_type: telegram_callback
      event_data:
        command: '/rebuild'
    - platform: event
      event_type: telegram_command
      event_data:
        command: '/rebuild'
    - platform: event
      event_type: telegram_command
      event_data:
        command: '/rebuild@casa_d_amore_bot'
    action:
    - service: script.system_rebuild

  - alias: telegram_intercom_hall_open_command
    mode: 'queued'
    trigger:
    - platform: event
      event_type: telegram_callback
      event_data:
        command: '/intercom_hall_open'
    action:
    - service: script.intercom_hall_open

  - alias: telegramm_remove_callback'
    mode: 'queued'
    trigger:
    - platform: event
      event_type: telegram_callback
    action:
    - service: script.telegramm_remove_message
      data_template:
        message_id: '{{ trigger.event.data.message.message_id }}'
        chat_id: '{{ trigger.event.data.chat_id }}'

  script:
    telegramm_send_home_text_custom_menu:
      mode: 'queued'
      sequence:
      - service: notify.telegram_home_group_id
        data_template:
          message: "{{ message }}"
          data:
            inline_keyboard: "{{ navigation }}"

    telegramm_send_home_text:
      mode: 'queued'
      sequence:
      - service: notify.telegram_home_group_id
        data_template:
          message: "{{ message }}"
          data:
            inline_keyboard: 
            - '❌ Закрыть :/hide_menu'

    telegramm_send_climat_text:
      mode: 'queued'
      sequence:
      - service: notify.telegram_climat_group_id
        data_template:
          message: "{{ message }}"
          data:
            inline_keyboard: 
            - '❌ Закрыть :/hide_menu'

    telegramm_send_secuirity_text:
      mode: 'queued'
      sequence:
      - service: notify.telegram_secuirity_group_id
        data_template:
          message: "{{ message }}"
          data:
            inline_keyboard: 
            - '❌ Закрыть :/hide_menu'

    telegramm_send_system_text:
      mode: 'queued'
      sequence:
      - service: notify.telegram_system_group_id
        data_template:
          message: "{{ message }}"
          data:
            inline_keyboard: 
            - '❌ Закрыть :/hide_menu'

    telegramm_send_photo:
      mode: 'queued'
      sequence:
      - service: notify.telegram_secuirity_group_id
        data_template:
          message: "{{ message }}"
          data:
            photo:
            - file: "{{ link }}"
            inline_keyboard: 
            - '❌ Закрыть :/hide_menu'

    telegramm_remove_message:
      mode: 'queued'
      sequence:
      - service: telegram_bot.delete_message
        data_template:
          message_id: '{{ message_id }}'
          chat_id: '{{ chat_id }}'
