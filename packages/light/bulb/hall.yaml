bulb_light_hall:
  light:
  - platform: template
    lights:
      bulb_light_hall_1:
        value_template: "{{ is_state('light.xiaomi_light_hall_1', 'on') }}"
        level_template: "{{ state_attr('light.xiaomi_light_hall_1', 'brightness') | int(0) }}"
        temperature_template: "{{ state_attr('light.xiaomi_light_hall_1', 'color_temp') | int(0) }}"
        supports_transition_template: "{{ true }}"
        min_mireds_template: 175
        max_mireds_template: 333
        turn_on:
        - service: script.bulb_light_hall_on
          data:
            entity_id: light.xiaomi_light_hall_1
        turn_off:
        - service: light.turn_off
          entity_id: light.xiaomi_light_hall_1
        set_level:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_1
          data:
            value: "{{ brightness }}"
        set_temperature:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_1
          data:
            value: "{{ color_temp }}"

      bulb_light_hall_2:
        value_template: "{{ is_state('light.xiaomi_light_hall_2', 'on') }}"
        level_template: "{{ state_attr('light.xiaomi_light_hall_2', 'brightness') | int(0) }}"
        temperature_template: "{{ state_attr('light.xiaomi_light_hall_2', 'color_temp') | int(0) }}"
        supports_transition_template: "{{ true }}"
        min_mireds_template: 175
        max_mireds_template: 333
        turn_on:
        - service: script.bulb_light_hall_on
          data:
            entity_id: light.xiaomi_light_hall_2
        turn_off:
        - service: light.turn_off
          entity_id: light.xiaomi_light_hall_2
        set_level:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_2
          data:
            value: "{{ brightness }}"
        set_temperature:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_2
          data:
            value: "{{ color_temp }}"

      bulb_light_hall_3:
        value_template: "{{ is_state('light.xiaomi_light_hall_3', 'on') }}"
        level_template: "{{ state_attr('light.xiaomi_light_hall_3', 'brightness') | int(0) }}"
        temperature_template: "{{ state_attr('light.xiaomi_light_hall_3', 'color_temp') | int(0) }}"
        supports_transition_template: "{{ true }}"
        min_mireds_template: 175
        max_mireds_template: 333
        turn_on:
        - service: script.bulb_light_hall_on
          data:
            entity_id: light.xiaomi_light_hall_3
        turn_off:
        - service: light.turn_off
          entity_id: light.xiaomi_light_hall_3
        set_level:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_3
          data:
            value: "{{ brightness }}"
        set_temperature:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_3
          data:
            value: "{{ color_temp }}"

      bulb_light_hall_4:
        value_template: "{{ is_state('light.xiaomi_light_hall_4', 'on') }}"
        level_template: "{{ state_attr('light.xiaomi_light_hall_4', 'brightness') | int(0) }}"
        temperature_template: "{{ state_attr('light.xiaomi_light_hall_4', 'color_temp') | int(0) }}"
        supports_transition_template: "{{ true }}"
        min_mireds_template: 175
        max_mireds_template: 333
        turn_on:
        - service: script.bulb_light_hall_on
          data:
            entity_id: light.xiaomi_light_hall_4
        turn_off:
        - service: light.turn_off
          entity_id: light.xiaomi_light_hall_4
        set_level:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_4
          data:
            value: "{{ brightness }}"
        set_temperature:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_4
          data:
            value: "{{ color_temp }}"

      bulb_light_hall_5:
        value_template: "{{ is_state('light.xiaomi_light_hall_5', 'on') }}"
        level_template: "{{ state_attr('light.xiaomi_light_hall_5', 'brightness') | int(0) }}"
        temperature_template: "{{ state_attr('light.xiaomi_light_hall_5', 'color_temp') | int(0) }}"
        supports_transition_template: "{{ true }}"
        min_mireds_template: 175
        max_mireds_template: 333
        turn_on:
        - service: script.bulb_light_hall_on
          data:
            entity_id: light.xiaomi_light_hall_5
        turn_off:
        - service: light.turn_off
          entity_id: light.xiaomi_light_hall_5
        set_level:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_5
          data:
            value: "{{ brightness }}"
        set_temperature:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_5
          data:
            value: "{{ color_temp }}"

      bulb_light_hall_6:
        value_template: "{{ is_state('light.xiaomi_light_hall_6', 'on') }}"
        level_template: "{{ state_attr('light.xiaomi_light_hall_6', 'brightness') | int(0) }}"
        temperature_template: "{{ state_attr('light.xiaomi_light_hall_6', 'color_temp') | int(0) }}"
        supports_transition_template: "{{ true }}"
        min_mireds_template: 175
        max_mireds_template: 333
        turn_on:
        - service: script.bulb_light_hall_on
          data:
            entity_id: light.xiaomi_light_hall_6
        turn_off:
        - service: light.turn_off
          entity_id: light.xiaomi_light_hall_6
        set_level:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_6
          data:
            value: "{{ brightness }}"
        set_temperature:
        - service: light.turn_on
          entity_id: light.xiaomi_light_hall_6
          data:
            value: "{{ color_temp }}"

  script:
    bulb_light_hall_on:
      mode: 'queued'
      sequence:
      - if:
        - condition: state
          state: 'off'
          entity_id: switch.switch_hall
        then:
        - service: switch.turn_on
          entity_id: switch.switch_hall
        else:
        - service: light.turn_on
          data_template:
            entity_id: "{{ entity_id }}"

  automation:
  - alias: 'bulb_light_hall_1'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: 'light.bulb_light_hall_1'
    - platform: state
      entity_id: 'sensor.bulb_light_brightness'
    - platform: state
      entity_id: 'sensor.bulb_light_temperature'
    condition:
    - condition: state
      entity_id: light.bulb_light_hall_1
      state: 'on'
    action:
    - service: light.turn_on
      entity_id: light.bulb_light_hall_1
      data_template:
        brightness: "{{ states('sensor.bulb_light_brightness') }}"
        color_temp: "{{ states('sensor.bulb_light_temperature') }}"

  - alias: 'bulb_light_hall_2'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: 'light.bulb_light_hall_2'
    - platform: state
      entity_id: 'sensor.bulb_light_brightness'
    - platform: state
      entity_id: 'sensor.bulb_light_temperature'
    condition:
    - condition: state
      entity_id: light.bulb_light_hall_2
      state: 'on'
    action:
    - service: light.turn_on
      entity_id: light.bulb_light_hall_2
      data_template:
        brightness: "{{ states('sensor.bulb_light_brightness') }}"
        color_temp: "{{ states('sensor.bulb_light_temperature') }}"

  - alias: 'bulb_light_hall_3'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: 'light.bulb_light_hall_3'
    - platform: state
      entity_id: 'sensor.bulb_light_brightness'
    - platform: state
      entity_id: 'sensor.bulb_light_temperature'
    condition:
    - condition: state
      entity_id: light.bulb_light_hall_3
      state: 'on'
    action:
    - service: light.turn_on
      entity_id: light.bulb_light_hall_3
      data_template:
        brightness: "{{ states('sensor.bulb_light_brightness') }}"
        color_temp: "{{ states('sensor.bulb_light_temperature') }}"

  - alias: 'bulb_light_hall_4'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: 'light.bulb_light_hall_4'
    - platform: state
      entity_id: 'sensor.bulb_light_brightness'
    - platform: state
      entity_id: 'sensor.bulb_light_temperature'
    condition:
    - condition: state
      entity_id: light.bulb_light_hall_4
      state: 'on'
    action:
    - service: light.turn_on
      entity_id: light.bulb_light_hall_4
      data_template:
        brightness: "{{ states('sensor.bulb_light_brightness') }}"
        color_temp: "{{ states('sensor.bulb_light_temperature') }}"

  - alias: 'bulb_light_hall_5'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: 'light.bulb_light_hall_5'
    - platform: state
      entity_id: 'sensor.bulb_light_brightness'
    - platform: state
      entity_id: 'sensor.bulb_light_temperature'
    condition:
    - condition: state
      entity_id: light.bulb_light_hall_5
      state: 'on'
    action:
    - service: light.turn_on
      entity_id: light.bulb_light_hall_5
      data_template:
        brightness: "{{ states('sensor.bulb_light_brightness') }}"
        color_temp: "{{ states('sensor.bulb_light_temperature') }}"

  - alias: 'bulb_light_hall_6'
    mode: 'queued'
    trigger:
    - platform: state
      entity_id: 'light.bulb_light_hall_6'
    - platform: state
      entity_id: 'sensor.bulb_light_brightness'
    - platform: state
      entity_id: 'sensor.bulb_light_temperature'
    condition:
    - condition: state
      entity_id: light.bulb_light_hall_6
      state: 'on'
    action:
    - service: light.turn_on
      entity_id: light.bulb_light_hall_6
      data_template:
        brightness: "{{ states('sensor.bulb_light_brightness') }}"
        color_temp: "{{ states('sensor.bulb_light_temperature') }}"
