curtain:
  input_number:
    curtain_bedroom_open: # 5
      max: 100
      min: 0
    
    curtain_bedroom_night: # 85
      max: 100
      min: 0
  
  automation:
  - alias: 'curtain_bedroom_night'
    mode: 'queued'
    trigger:
    - id: 'close'
      platform: state
      entity_id: 'input_boolean.is_night_mode' 
      from: 'off'
      to: 'on'
    - id: 'open'
      platform: state
      entity_id: 'input_boolean.is_night_mode' 
      from: 'on'
      to: 'off'
    action:
    - choose:
      - conditions:
        - condition: trigger
          id: 'close'
        sequence:
        - service: cover.set_cover_position
          entity_id: cover.curtain_bedroom
          data_template:
            position: "{{ states('input_number.curtain_bedroom_night') | int(0) }}"
      - conditions:
        - condition: trigger
          id: 'open'
        sequence:
        - service: cover.set_cover_position
          entity_id: cover.curtain_bedroom
          data_template:
            position: "{{ states('input_number.curtain_bedroom_open') | int(0) }}"

  - alias: 'curtain_living_controll'
    mode: 'queued'
    trigger:
    - id: 'close'
      platform: state
      entity_id: sensor.living_cube_action
      to: 'rotate_right'
    - id: 'open'
      platform: state
      entity_id: sensor.living_cube_action
      to: 'rotate_left'
    action:
    - service: script.console
      data:
        message: |
          position: {{ state_attr('cover.curtain_bedroom', 'position') | int(0) }}
          destination: {{ state_attr('cover.curtain_bedroom', 'position') | int(0) + 20 }}
    - choose:
      - conditions:
        - condition: trigger
          id: 'close'
        sequence:
        - service: cover.set_cover_position
          entity_id: cover.curtain_bedroom
          data_template:
            position: "{{ state_attr('cover.curtain_bedroom', 'position') | int(0) + 20 }}"
      - conditions:
        - condition: trigger
          id: 'open'
        sequence:
        - service: cover.set_cover_position
          entity_id: cover.curtain_bedroom
          data_template:
            position: "{{ state_attr('cover.curtain_bedroom', 'position')| int(0) - 20 }}"
